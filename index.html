<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=<device-width>, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet">
    <style>
    
    row{
        border: 1px solid black;
    }
    .container{
        border: 1px solid red;
        height: 25rem;
    }
    font{
    font-family: 'Lato', sans-serif;
    }
    .head-row{
        background-color: black;
        color: white;
    }
    .btn{
        background: black;
    }
    .main{
       
    }
    .btn-search{
        border-radius: 10px;
        background-color: black;
        color: white;
    }
    .section1-sub{
        font:15px;
    }
    .dynamicBtn{
        padding-right: 10px;
        background: black;
        border-bottom: 1px red;
        box-shadow: none;
        width: 160px;
        color: white;
    }
    .inputClass{
        text-transform:uppercase;
    }

    </style>
</head>
<body>
    <div class="container col-10">
        <div class="row justify-content-center p-3 head-row">
            <div class="col-12 head-div">
                <h3 class="text-center heading">Weather Dashboard</h3>
            </div>
        </div>
        <div class="row mt-3 main">
            <div class="col-4">
                <form>
                    <input type="search" class="inputClass mt-1" id="search-input" placeholder="Enter city...">
                    <button type="submit" class="btn-search">Search</button>
                </form>  
                <div id="createBtn" class="mt-2">

                </div>  
            </div>
            <div class="col-8 section1">
                <div class="col-12 section1-sub p-3">
                    <div class="city"></div>
                        <div class="mt-3 ">
                            <div class="temp"></div>
                            <div class="humidity"></div>
                            <div class="wind"></div>
                            <div class="uv"></div>
                        </div>
                </div> 
                <div class="col-12">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>

                </div>   
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

    $(document).ready(function(){
        var cityButton;
        var buttonsArray;
        var cityButton;
        if (localStorage.getItem("buttonsKey") !== null)
        {
            buttonsArray = JSON.parse(localStorage.getItem('buttonsKey'));
            $("#createBtn").empty();
            for(var i = 0; i < buttonsArray.length; i++){   
                
            $("#createBtn").append(`<button class="dynamicBtn btnArray mt-1">${buttonsArray[i]}</button><br/>`);
            }
        }
        $(".btn-search").on("click", createBtn);
        
        function createBtn(e){
            e.preventDefault();
            var cityButton = $("#search-input").val().toUpperCase();
            if (localStorage.getItem("buttonsKey") == null){
            var buttonsArray = [];
            buttonsArray.push(cityButton);  
            $("#createBtn").append(`<button class="dynamicBtn mt-1">${cityButton}</button>`);
            localStorage.setItem('buttonsKey', JSON.stringify(buttonsArray));
            } 
            else{   

                buttonsArray = JSON.parse(localStorage.getItem('buttonsKey'));
                if(buttonsArray.indexOf(cityButton) == -1){
                buttonsArray.push(cityButton); 
                console.log(cityButton)
                $("#createBtn").prepend(`<button class="dynamicBtn mt-1">${cityButton}</button>`);   
                }
                localStorage.setItem('buttonsKey', JSON.stringify(buttonsArray));
            }
        }
    
    });

    function showinfo(CityButton){
    
    var APIKey = "7635c7831665c79d31c4b8a3b9478080";
    // Here we are building the URL we need to query the database
    var queryURL = "https://api.openweathermap.org/data/2.5/weather?q=" + cityButton + "&APPID=" + APIKey;
    // Here we run our AJAX call to the OpenWeatherMap API
    $.ajax({
    url: queryURL,
    method: "GET"
    }).then(mainSectionInfo);

    var queryURLNew = "api.openweathermap.org/data/2.5/forecast?q=" + cityButton + "&APPID=" + APIKey;
   
    $.ajax({
    url: queryURLNew,
    method: "GET"
    }).then(forecastSection);
    
    }    
    
    function mainSectionInfo(cityButton){

    console.log(queryURL);   
    console.log(response);
    console.log(response.main.temp)

    $(".city").html(`<h4> ${cityName}   </h4>`);
    $(".temp").text("Temperature:" + " " + response.main.temp);
    $(".humidity").text("Humidity:" + " " + response.main.humidity);
    $(".wind").text("Wind:" + " " + response.wind.speed)
    $(".uv").text("UV Index:" + " " + response.wind.speed)
    $(".section1-sub").css("border", "1px solid lightgrey")

     }
    
    function forecastSection(cityButton){ 

    // Here we run our AJAX call to the OpenWeatherMap API
    
    //end of function forecast
    };

    
    

    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>    

</body>
</html>